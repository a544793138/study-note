Cloud 是微服务架构。

需要熟悉 SpringMVC + Spring /SpringBoot + Mybatis + git + maven ...

Cloud 不是一种技术，而是一堆技术的集合，大概 21 种技术

这里挑选常用的说，俗称 Cloud 技术**五大神兽: Eureka, Ribbon/Feign, Hystrix, zuul, Config**。

# 1 面试题

- 什么是微服务

- 微服务之间是如何独立通讯的

- Spring Cloud 和 Dubbo 有哪些区别

- Spring Boot 和 Spring Cloud, 请谈谈你对他们的理解

- 什么是服务熔断？什么是服务降级？

- 微服务的优缺点分别是什么？项目开发中碰到的坑

- 你所知道的微服务技术栈有哪些，列举一二

- Eureka 和 zookeeper 都可以提供服务注册与发现功能，请说说两个的区别？

  ...

# 2 微服务与微服务架构

微服务与微服务架构是不一样的。

- 微服务 - 强调的是一个点，一个个个体，关注一个问题，提供一个服务，相当于 IDE 里一个个小的工程，仅提供一种服务。

- 微服务架构 - 就是指马丁福勒提出的一个概念。简单来说，微服务架构风格是**一种将一个单一应用程序开发为一组小型服务**的方法，每个服务运行在**自己的进程**中，服务间通信采用**轻量级通信机制**(通常用HTTP资源API)。

就好比中国 56 个民族，整个中国的民族架构，就是微服务架构，而其中一个个民族就是一个个的微服务。

## 2.1 马丁富勒微服务原文记录

现在还没有一个统一的标准的定义，但有大概说法

**提倡将单一应用程序，按业务拆分为多个小服务，每个服务运行在独立的进程中**。

> 为什么说没有统一的定义，一个原因就是这个拆分角度。

**服务之间采用轻量级的通信机制互相沟通**

> **Spring Cloud 与 Dubbo 有什么区别，其中一个区别就在这里 !!!!**：
>
> - Dubbo 是采用基于 RPC 远程过程调用的机制通信
> - Spring Cloud 是采用 HTTP 的 RESTful API 接口进行通信

分布式 - 专业的事情交给专人做，尽量降低耦合度

每个服务独立的开发，独立部署，都可以提供单个业务功能，拥有自己独立的数据库。

可以使用不同的语言开发。

> 原文翻译：http://blog.cuicc.com/blog/2015/07/22/microservices/
>
> 简单来说，微服务架构风格是**一种将一个单一应用程序开发为一组小型服务**的方法，每个服务运行在**自己的进程**中，服务间通信采用**轻量级通信机制**(通常用HTTP资源API)。这些服务围绕业务能力构建并且可通过全自动部署机制独立部署。这些服务共用一个最小型的集中式的管理，服务可用不同的语言开发，使用不同的数据存储技术。 

![](images\单体与微服务应用.png)

## 2.2 微服务的优缺点

- 优点
  - 服务足够小，业务理解容易
  - 开发简单效率高
  - 小团队
  - **低耦合，独立**
  - 不同服务可以使用不同语
  - **微服务是业务逻辑代码，不会和 HTML/CSS 或其他组件界面耦合**
  - **灵活搭配，可以有独立的数据库，也可以有统一的数据库**

- 缺点
  - 分布式系统的复杂性
  - 运维难度，随着服务增加，运维压力会增大
  - 系统部署依赖
  - 服务间通信成本
  - 数据一致性
  - 系统集成测试
  - 性能监控

## 2.3 微服务的技术栈

在了解微服务的技术栈这个概念前，先考虑一个问题：当我们讨论一个分布式的微服务架构时， 需要有哪些维度？

> 维度 - 可以理解为方面。
>
> 一个类比思维，比如我们在讨论数字时代生活时，需要有哪些维度？我们会想到手机，电脑，路由器，充电宝，智能家居等等。
>
> 我们也容易想到了一些对这些方面都有涉及的公司 —— 小米。小米杂货形成的生态圈，就形成了数字生活的架构。

有了上面的思维准备，我们就容易想到一个分布式的微服务架构，并不会单单的由一种技术支持完成，必然依赖着各种各样的技术和框架，而在技术界也有像小米一样的公司，为我们提供了所谓的微服务技术栈，形成了一套体系，那就是 Spring Cloud。

当然，Spring Clound 里除了 Spring 公司本身的技术外，还兼容和依赖着其它第三方的公司。

![](images\微服务技术栈.png)

## 2.4 为什么选择 SpringCloud

**为什么我们更多选择 SpringCloud 作为微服务架构呢？**

首先要知道，不是只有 SpringCloud 才是微服务架构，还有很多其它的，微服务架构是一个理论，就好比买汉堡的就有肯德基，麦当劳，汉堡王，华莱士等等。

原因可以从以侠几个方面：

- 整个解决方案和框架成熟度 - 框架已经成型且成熟了，能适用于多种多样的业务场景
- 社区热度 - 学习了这个框架的人，形成了主流
- 可维护性 - 因为多人使用而产生的多种问题，已经有很多相关的问题解决答案
- 学习曲线，学习成本 - 容易学习的，拥有完整且不断更新的官方文档，或者是与另一种技术一脉相承的。

**当前各大 IT 公司的微服务架构有哪些呢？**

- 阿里 - Dubbo / HSF
- 京东 - JSF
- 新浪微博 - Motan
- 当当网 - DubboX

**当前比较重点的是 Dubbo3.0 和 SpringCloud**

不谈 Dubbo 和 SpringCloud 的对比，看的视频已经挺老了。但 SpringCloud 是一个完整的微服务框架。

# 3 Spring Cloud 入门

## 3.1 简介

SpringCloud 是一堆技术。这是 Spring 官网中对一个简单分布式系统的图例。

![](images\SpringCloud结构.png)

SpringCloud 是基于 Springboot，提供的一整套微服务解决方案，包括服务注册与发现，配置中心，全链路监控，服务网关，负载均衡，熔断器等组件，除了基于 NetFlix 的开源组件做高度抽象封装外，还有一些选型中立的开源组件。

## 3.2 SpringCloud 与 SpringBoot 的关系

- boot 就是一个个的服务，Cloud 是整个微服务框架，包含一系列的技术

- Cloud 将 boot 开发的服务管理，整合起来

- boot 就像医院里的一个个科室，而 Cloud 是整个医院

- boot 可以独立，但是 Cloud 依赖 boot。

- Spring boot 专注与快速、方便的开发单个微服务个体，SpringCloud 关注全局的服务治理框架

## 3.3 SpringCloud 与 Dubbo 的区别

> 不确定现在最新 Dubbo 是否仍如此，仅记录视频里说到的

- SpringCloud 没有采用 RPC 通信，而是采用了 HTTP 的 REST，Dubbo 采用了 RPC 通信。REST 比 RPC 更加灵活，不存在代码级别的强依赖。
- SpringCloud 拥有相对更完整的微服务架构，更种需要使用到的组件都与 Springboot 一脉相承。
- 社区支持和热度

# 4 Rest 微服务构建案例工程模块

# 5 Eureka 服务注册与发现

# 6 Ribbon 负载均衡

# 7 Feign 负载均衡

# 8 Hystrix 断路器

# 9 zuul 路由网关

# 10 Spring Cloud Config 分布式配置中心

# 11 总结

